{
	"name": "JCP Backend Service - Spring Boot + PostgreSQL",
	"dockerComposeFile": "docker-compose.yml",
	"service": "app",
	"workspaceFolder": "/workspace",

	"features": {
		"ghcr.io/devcontainers/features/java:1": {
			"version": "17",
			"installGradle": true,
			"gradleVersion": "8.5"
		},
		"ghcr.io/devcontainers/features/git:1": {},
		"ghcr.io/devcontainers/features/github-cli:1": {}
	},

	"customizations": {
		"vscode": {
			"extensions": [
				"fwcd.kotlin",
				"vscjava.vscode-gradle",
				"vscjava.vscode-spring-boot",
				"Pivotal.vscode-boot-dev-pack",
				"mtxr.sqltools",
				"mtxr.sqltools-driver-pg"
			],
			"settings": {
				"java.jdt.ls.java.home": "/opt/java/openjdk",
				"gradle.nestedProjects": true,
				"spring-boot.ls.checkjvm": false,
				"sqltools.connections": [
					{
						"name": "Local PostgreSQL",
						"driver": "PostgreSQL",
						"server": "postgres",
						"port": 5432,
						"database": "appdb",
						"username": "appuser",
						"password": "apppass"
					}
				]
			}
		}
	},

	"remoteEnv": {
		"GRADLE_USER_HOME": "/workspace/.gradle",
		"DB_HOST": "postgres",
		"DB_PORT": "5432",
		"DB_NAME": "appdb",
		"DB_USER": "appuser",
		"DB_PASSWORD": "apppass",
		"SPRING_PROFILES_ACTIVE": "dev"
	},

	"postCreateCommand": "bash -c 'chmod +x gradlew && ./gradlew --version'",

	"postStartCommand": "echo 'âœ… Backend service ready. Database: postgres:5432/appdb'",

	"forwardPorts": [8080, 5432],

	"portsAttributes": {
		"8080": {
			"label": "Spring Boot App",
			"onAutoForward": "notify",
			"protocol": "http"
		},
		"5432": {
			"label": "PostgreSQL",
			"onAutoForward": "silent"
		}
	},

	"waitFor": "postCreateCommand"
}
